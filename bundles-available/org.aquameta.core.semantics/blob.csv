\\x01211fbdd6f7a3435910ff85d6fb6fe3d60c617ea663890ffedbef19eb19fd3e	/org.aquameta.core.semantics
\\x01aa7c58cf07709ddf4e5dd3582e78ea1fa09920604bdcee4eed816cb479019c	13cb8ae2-453c-4f28-b54f-fab15e4029f3
\\x03208e6beeb0a1dce37400edbb304e1702937ae4d9067dc6fd822b388b6bcfcd	3448afcd-f2d3-4c84-a8e6-73917266bbb6
\\x032feb0d29402db61b8d8f960154ec93a0d0b012c29bb40544bafaac1dc53d10	d16078bd-a5dd-484b-b23b-dc7b811619a0
\\x03d1cc6e11385db2f06ec5b9249d67216fc3200142f037e9102dc819b3e002ba	 var w = $('#'+id);\n\n\n/* SETUP */\nvar rel_name;\nvar relation = datum;\n\nif (!(datum instanceof AQ.Rowset)) {\n    datum = datum.rows()\n    .then(function(rows) {\n        rel_name = rows.relation.schema.name + '.' + rows.relation.name;\n        w.find('.title').text(rel_name);\n        return rows;\n    });\n} else {\n    rel_name = datum.relation.schema.name + '.' + datum.relation.name;\n    relation = rows.relation;\n    w.find('.title').text(rel_name);\n}\n\ncontext = typeof context != 'undefined' ? context : {};\n\n\n// Use columns from meta_data if included\nif (!datum.columns) {\n    var columns = endpoint.schema('meta').table('column').rows({\n        where: {\n            name: 'relation_id',\n            op: '=',\n            value: relation.id\n        },\n        include: ['id', 'name']\n    });\n}\nelse {\n    var columns = Promise.resolve(datum.columns);\n\n}\ncolumns = columns.then(function(col) {\n    return col.map(function(c) {\n        return typeof c.get != 'undefined' ? c.get('name') : c.name;\n    });\n});\n\n// Sync the column names in the table heading\nwidget.sync(columns, w.find('.columns'), function(column) {\n    return '<th>' + column + '</th>';\n});\n\nif (!datum.length) {\n    w.find('.columns').hide();\n}\n\n// Sync the rows in this table\nwidget.sync(datum, w.find('table'), function(row) {\n    return widget('semantics/grid_row', row);\n});\n\n\n// Pop up a new_row widget\nw.find('.new_row').click(function() {\n    w.append(\n        widget('core:modal', {\n            content: widget('semantics/new_row', relation, { context: context })\n        })\n    );\n});\n\n
\\x064dc1907a78508ddfa4651e7a6415f3dfa81bade729a9282523dc467f01b038	form_field_label
\\x06a434fca85814a068a6dbb9cc5cddb35d4ed6bbdfb6eddab990d6d289ed6e67	132a51d6-2341-48e2-bcd9-9be794bd9942
\\x083a2768f5179d96f11b892b4bb9159fc6e1fbd015acedc99830778a855ddc49	.{{= name }} {\n    position: relative;\n    padding: 0.5rem;\n    color: #333;\n    background-color: #888;\n    text-overflow: ellipsis;\n    overflow: hidden;\n}\n\n.{{= name }} {\n    border-top: 1px solid #333;\n}\n\n.{{= name }}:hover {\n    background-color: #666;\n}\n\n.{{= name }}:active {\n    top: 1px;\n    background-color: lightyellow !important;\n}\n\n.{{= name }}.selected {\n    background-color: #333;\n    color: #aaa;\n}
\\x0b89118d2fe5c31f13d95176dba7ecdc7eb9ebeaaf8d28e28b14a68f337c9276	d1874571-9b11-4ecf-a65d-454de53683b7
\\x0ba9b693da6b2dbb83cee744e953ac5cb5f3d2cb93a4a0550b607a7fdcca02c2	.{{= name }} {\n}
\\x0d4c36b04af1613ede37fba252ffdf94d543e19aaa9f8393baea28b65c5b4d3c	form_field_display
\\x0d4fe423f17bbdb3b011171f498d3a57ae9ded3ec297fd5b52767661ab92c360	("(meta)",policy_id)
\\x111508a8170462025e56a11ceddca979e888b8efee10990853f9cf6bc0747ffb	916d8772-e268-42c7-bcd4-8e796d007b96
\\x143cd24cf7d6a8386a4f87f0d0348a4f49d8a3e6b37681c0ec046abf7998921d	191b0c4b-75a3-462c-bb97-89340a023afc
\\x1655f3c5a53bdfd38f43e9a295881a3842474490451e5aad4179ef5b2fc02ed7	form_label
\\x1885bc064462b9b7c58bc60926a528da1b0c647207a4da4d03dfb87b0e1a37b0	501222cf-f62c-4cfb-b7bc-937dca0c7fca
\\x1a20d8abb18eca2184cf53d119e2aa02a8a4d6a25349541ce8ad9ee2f4599f7c	b4117506-4236-4f65-9a13-c7dca950ddf0
\\x1e100b712d66b4551e6a57fc77804fee3f66b3c595d87cd09f2d516ea2aab92d	<tr id="{{= id }}" class="{{= name }}"></tr>
\\x212aa4bfa498bc403f4ce89d00ce7fcbc1f85008f11a3647f184385ccf5280bf	45bcce0e-96a8-4cb8-9d3f-4cf6b1555140
\\x2157b4c05d489ab6a206b567237c4169dad4321e27a34cd63b12d87f9c13d0e8	88d558bb-a389-4012-872e-665ec6b34982
\\x227ae55bd869eedf9afbc17dfc4aa0e4722725413ae5f3fd6ad8644f8e1de4f6	c7e98fc9-4324-4006-9738-ac3d869201ba
\\x23ad909a8dddae23b68766c5c9646c69e6d1e5cb2adc1c3884a024052adbe793	127fe8b9-7429-475f-a062-20bbe09b1280
\\x255f77d2f1800b1af58e5f202e94f031c8507aa97c4a85d3fdbf5f06b9c327fa	("(meta)",role_id)
\\x25c653995f157721ebb109afde90327fc97e2473e672d72d6ea7c784e960a6e2	("(""(widget)"",widget)",server_js)
\\x27564f2066a531bd639714e2489f68d5092b2800f8696f7348d2c8dcc1d97e31	df6d1b09-280a-436e-8b89-8d41feb95173
\\x28dbe35bcede4020d09f28d7c4742576ce4ac8172660ce2aca044e65fb53499e	f67acea7-d3d4-427b-8749-973c6664ce9a
\\x2a97516c354b68848cdbd8f54a226a0a55b21ed138e207ad6c5cbb9c00aa5aea	demo
\\x2c62ef95c314ac7f56c2b1dbf7bb43adc2238f5b9bf36654a29f7ae1b1aab4a8	var w = $("#"+id);\n\n\nrow.relation.row(row.pk_column_name, row.pk_value)\n.then(function(row) {\n    var rel_name = row.relation.schema.name + '.' + row.relation.name;\n\n    row.columns.forEach(function(col) {\n        w.append(\n            '<tr>' +\n            \t'<td>' + \n\t\t            widget('semantics/form_label', row.field(col.name)) + \n        \t    '</td>' +\n            \t'<td>' + \n\t\t            widget('semantics/form_field', row.field(col.name)) + \n\t            '</td>' +\n            '</tr>');\n    });\n\n\n    w.find('.delete_row').on('click', function() {\n        if (confirm('Are you sure you\\'d like to delete this row?')) {\n            row.delete()\n            .then(function() {\n                w.trigger('status', ['Row deleted from ' + rel_name, 'success']);\n                w.trigger('row_detail_delete');\n                w.trigger('done');\n                w.trigger('close_tab_self');\n                w.remove();\n            })\n            .catch(function() {\n                w.trigger('status', ['Failed delete on ' + rel_name, 'fail']);\n            });\n        }\n    });\n\n    w.find('.save_row').on('click', function() {\n        row.update()\n        .then(function() {\n            return;\n        })\n        .catch(function() {\n            alert('failed to save '+rel_name);\n        });\n    });\n\n});
\\x30286044eb812d9d6da3261d9adbe8e51500d0e4ac95f6c67af23c12836a7894	e55de128-dac3-4e87-be70-3665fb49a96e
\\x3082ae5d03ebde042fe90d3164851992a61d8842b38e3843ea784a6c3ddfe9df	d5803ea0-00d3-4297-a78b-1599d2988c05
\\x3121555164dca28e07d49886bcb65137ffca964d2faf39294479e895699485db	("(meta)",function_id)
\\x32de52c95b9b4828b83f317d9373fd4f33e72ffb2bb546ef70b337ca7f20f4e6	<table id="{{= id }}" class="{{= name }}">\n    <tr>\n        <th class='no_border'>\n            <button class='delete_row'>Delete</button>\n        </th>\n        <th class='no_border'></th>\n    </tr>\n    <tr>\n        <th>Field</th>\n        <th>Data</th>\n    </tr>\n</table>
\\x345a6c53e5100836b096fa3def99ea2e3409e1e0b437e0d5cc487b1f0b929b4c	grid_view
\\x3685566284c83299b0b79d7f7d8077d41a120e4f4fbdbbd62c4ae85c2dfa18eb	text_identifier
\\x37e1e07fbaeff5e45f47eb4d16543d6a0f284d7e5faed6faaf56bf526d5dffba	("(""(widget)"",dependency_js)",content)
\\x3922da143794910d6f261b3c23ad7d62e1c6f966d36e08ca4d9e5dbd8eb44f9c	27004682-519f-439e-83bc-97a9338cd454
\\x39931eccbc22d36dd20a10232d45e7474ac2c22398cf88004b857da89c6db559	.{{= name }} {\r\n}
\\x3c00c08c091cc37694150bf3ce3f23fe9766956fe3c0f1e396d4ed22657c054d	<span id="{{= id }}" class="{{= name }}">\n    <nobr>\n    <span class='label'>\n    </span>\n    </nobr>\n</span>
\\x3cc481f8005a6f9ea4fe760e610951bd0e13ca0944a4fa4e0dd3de61f85b39c8	var w = $('#'+id);\n\nw.data('valid', true);\nw.data('name', datum.name);\nw.data('value', '');\n\nw.find('input').on('keyup', function(e) {\n    w.data('value', $(this).val());\n});
\\x3e75ef1d3fb0e83d961e4c8aa2375f45072767c9a619896f1adc14a573c8ddfa	8e0a718c-420d-4d46-9239-bf213e433d17
\\x40568bc133b8c56baec66d89ff38109956cc2fb08c7fef23583236338e452388	<div id="{{= id }}" class="{{= name }}">\n    {{= field.name }}\n</div>
\\x4163f3cd0286f2c2154c1129243ec4492d4994efb5a3c3cf48f3764d45adb718	.{{= name }} { \n    position: relative;  \n} \n
\\x46b37692a8bb093ca9bc5f6134c825fb32b307da7954116111aad9e5142fa719	form_display
\\x47d71156382a8a207445af15ac3c2be99d512296ee7127538adfca5e270f6cdc	var w = $("#"+id);\n\n\nrow.relation.row(row.pk_column_name, row.pk_value)\n.then(function(row) {\n    var rel_name = row.relation.schema.name + '.' + row.relation.name;\n\n    row.columns.forEach(function(col) {\n        w.append(\n            '<tr>' +\n            \t'<td>' + \n\t\t            widget('semantics/form_label', row.field(col.name)) + \n        \t    '</td>' +\n            \t'<td>' + \n\t\t            widget('semantics/form_field', row.field(col.name)) + \n\t            '</td>' +\n            '</tr>');\n    });\n\n\n    w.find('.delete_row').on('click', function() {\n        if (confirm('Are you sure you\\'d like to delete this row?')) {\n            row.delete()\n            .then(function() {\n                w.trigger('status', ['Row deleted from ' + rel_name, 'success']);\n                w.trigger('row_detail_delete');\n                w.trigger('done');\n                w.remove();\n            })\n            .catch(function() {\n                w.trigger('status', ['Failed delete on ' + rel_name, 'fail']);\n            });\n        }\n    });\n\n    w.find('.save_row').on('click', function() {\n        row.update()\n        .then(function() {\n            return;\n        })\n        .catch(function() {\n            alert('failed to save '+rel_name);\n        });\n    });\n\n});
\\x48ec2491732fce238e9f415eb2913cc7342036e5f95d0d58a415cbb9f52b3e19	var w = $("#"+id);\n\nvar rel_name = datum.schema.name + '.' + datum.name;\nw.find('.rel_name').text(rel_name);\n\ncontext = typeof context != 'undefined' ? context : {};\n\n\n// look up this row's columns\nendpoint.schema('meta').table('column').rows({\n    where: [{\n        name: 'relation_id',\n        op: '=',\n        value: datum.id\n    }, {\n        name: 'primary_key',\n        op: '=',\n        value: false\n    }],\n    include: ['id', 'name']\n})\n.then(function(columns) {\n    \n    if (!columns.length) {\n        w.text('Inserting defaults...');\n        return setTimeout(insert, 2000);\n    }\n    widget.sync(columns, w, function(c) {\n        if (Object.keys(context).indexOf(c.get('name')) == -1) {\n            return widget('semantics/new_field', datum.column(c.get('name')));\n        }\n    });\n});\n\n\nw.find('.save_row').on('click', save);\nw.on('save', save);\n\nfunction save(e) {\n    console.log('saving....');\n    e.stopPropagation();\n    \n    var new_fields = w.find('.new_field');\n    var args = {};\n    var invalid;\n    \n    for (var i = 0, f; i < new_fields.length; i++) {\n        f = $(new_fields[i]);\n        console.log(f.data('valid'), f.data('name'), f.data('value'));\n        \n        if (!f.data('valid')) {\n            f.addClass('invalid');\n            invalid = true;\n        }\n        if (typeof f.data('value') == 'undefined') {\n            continue;\n        }\n        args[f.data('name')] = f.data('value');\n    }\n\n    if (!invalid) {\n        insert(args);\n    } else {\n        w.trigger('status', 'Invalid values...');\n    }\n}\n\nfunction insert(args) {\n    \n    args = Object.assign(args || {}, context);\n    \n    datum.insert(args)\n    .then(function() {\n        w.trigger('status', 'New row on ' + rel_name);\n        w.trigger('done');\n    }).catch(function() {\n        w.trigger('status', 'Failed insert on ' + rel_name);\n    });\n}\n\n
\\x4938388f0c68650a2120ab03dfbf8e39b08edca0d086b3c3fd02e84e501a5fab	var w = $("#"+id);
\\x4adc081e0e3429ba4a075bbfec14445fd10cdda73dc1f824339bf920bdde781b	619b182f-4a17-4111-905f-091cfe578842
\\x4b36b17ec004d8990305b06b1bcf65383450d800736cbf20c41ad412783f4199	grid_label
\\x4eb02847bcfdabc0fc8fff973193d434a671df2e3063d2e9b481ba6dc0655a44	form_edit
\\x503c6966b8dc5a6a3cf129f2e0344d416e2e7df9f68d2c248cbc7411190ade2f	list_item
\\x5121eeb5feedc81d0ec9d95a2d77dd8857eb4ad92607ed791a6411093b1c26b0	<!DOCTYPE html>\n<html lang="en">\n    <head>\n\n        <title>Aquameta</title>\n        <script src='/system.js'></script>\n        \n        <!--semantic ui + themes + style switcher -->\n        \n        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css">\n        <script type="text/javascript" src="/assets/js/styleswitcher.js"></script>\n        <!--link href="/assets/css/semantic.superhero.min.css" rel="alternate stylesheet" title="superhero">\n        <link href="/assets/css/semantic.darkly.min.css"    rel="alternate stylesheet" title="darkly">\n        <link href="/assets/css/semantic.lumen.min.css"     rel="alternate stylesheet" title="light">\n        <link href="/assets/css/semantic.slate.min.css"     rel="alternate stylesheet" title="dark"-->\n        \n        <!-- script src="https://cdn.jsdelivr.net/npm/peerjs@0.3.20/dist/peer.min.js"></script -->\n\n        <meta http-equiv="Content-type" content="text/html; charset=utf-8">\n        <meta name="viewport" content="width=device-width">\n    </head>\n    <body></body>\n    <script>\n        System.import('/widget.js').then(function(widget) {\n            System.import('//cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.js').then(function(s) {\n\n                var db = new AQ.Database('/endpoint/0.2', { evented: 'no' });\n                window.endpoint = db;\n\n                AQ.Widget.import('com.aquameta.datasphere', 'sphere', db);\n                AQ.Widget.import('org.aquameta.core.ide', 'ide', db);\n                AQ.Widget.import('org.aquameta.ui.p2p', 'p2p', db);\n                AQ.Widget.import('org.aquameta.ui.auth', 'auth', db);\n                AQ.Widget.import('org.aquameta.ui.layout', 'layout', db);\n                AQ.Widget.import('org.aquameta.core.semantics', 's', db);\n                AQ.Widget.import('org.aquameta.ui.tags', 'tag', db);\n\n                $('body').append(widget('ide:base', {\n                    content: widget('s:demo')\n                }));\n                $('body').append(widget('ide:debugger3_manager'));\n\n            });\n        });\n    </script>\n</html>
\\x5191aad4c0ef9da31c0ad80b742f176c998db2a3afabafc541c84648bb57b720	fbcd433f-4644-4cf6-8695-3057fd928db3
\\x51b372882554719b446bf0437acf8721114ac14b103ffaec218aebb031a4291c	9a04641e-2348-41d5-86fe-3ad726dbaa94
\\x526a9a2ab6038cbef0b92b91a5a9e515a96520949ed499ec9a58a77a9d6423c0	<tr id="{{= id }}" class="inline field {{= name }}">\n    <td>{{= datum.name }}</td>\n    <td><input type="text" placeholder="{{= datum.name }}"></td>\n</tr>
\\x53144653b47b6ba4c4266957e471c880beece5902de2b51d2c733bab349898be	("(""(widget)"",widget)",post_js)
\\x55696656b833c8c131c1f3c37a611a3e6dc9cd47eb78f11631c1b33568e46223	("(meta)",type_id)
\\x562347c10967c9834719b8a8843ef8de74fd5bf4e51169fc284d64796f1b5385	30c85abd-fa53-4429-b088-5e78c7589568
\\x57ae1612b9692014484953cfe0da9216432bd372ab84a1b8041cf3b991fc9a87	506990f8-99c0-4441-a3fd-04ec402d7e22
\\x588c2b2b31fe728e18b1e5fd84a149f44e0daa5f44a8bbc3c15e25a2f3098e51	47bb232f-c358-465e-999f-c5fae1d1ee45
\\x5ab4b4e6ce5d1434467038d23009ece39731cfe6d23a7a740c8cadeea9823f72	faf836cf-b1eb-4173-b2f5-c14dfc79d3d3
\\x5c6ab9c98ffa222fbebf9a967d4f46c3d4f3710c8d8055a2eb59b6752c3f3dce	1d650655-0d06-426f-9f45-fb1435799d04
\\x5d81d9a0a72c549dd152ac8aa60075df47f551f320d4ba73c707b05005abf7e9	7e7fa68f-46e6-4d9f-bdb0-74449059ae7c
\\x5e5db985019cc0a1d1164b4cc01c739041592e83de60581d0d6fa3b556e02058	grid_field_display
\\x5feceb66ffc86f38d952786c6d696c79c2dbc239dd4e91b46729d73a27fb57e9	0
\\x61e579c7bfd49be247a1e475ae6a2ab3a535bf6a3fd0b6de33b2885cfe5c2126	grid_view_label
\\x62da487a949e6923c91f4bf54ccb07b387d6968c43a187c7af29ea72f5f456cf	0b3b5614-8338-4d32-8290-fbb213d1b7c1
\\x6406a032ce58b9b7ebc632981d04a74d8bc011e52651a700cb6d5cb4a2cb8e37	138b0f75-82c9-4eb5-afbf-c34bcbf0b008
\\x64406c8ff97590ad1226c35ad7e4596ec21afd822eac78df1c26f67f4cf93de9	67f9ea1f-da5e-4bf7-ac01-59de72240047
\\x64b9660c51ba9b5d90226c958cd294c810fb6e56565f54e6b593b25d53f24d23	("(""(widget)"",widget)",html)
\\x67cc1a01a625e8ef275524a5464c110810ce18d9c84ed0c3579d290590e90563	("(""(endpoint)"",template_route)",args)
\\x6a4d379530d1e33034c9dbfab49a9c0f5ca4e1850eeb4c31a06daa65b101f673	var w = $('#'+id);\nw.data('field', field);\n\nvar original_value = field.value;\nw.data('revert_field', function() {\n    field.value = original_value;\n    return field;\n});\n\n// defaults to display and both modes available\nvar mode = starting_mode;\nvar display_available = (available_modes == 'both' || available_modes == 'display');\nvar edit_available = (available_modes == 'both' || available_modes == 'edit');\n\n// defaults\nif (typeof label_widget == 'undefined' || label_widget == false) {\n    label_widget = 'sem_form_field_label';\n}\nif (typeof display_widget == 'undefined' || display_widget == false) {\n    display_widget = 'field_display';\n}\nif (typeof edit_widget == 'undefined' || edit_widget == false) {\n    edit_widget = 'field_edit';\n}\n\n\nw.find('.label').html(widget(label_widget, { field: field, column_id: false }));\n\n\n// starting mode\nif (mode == 'display') {\n    w.find('.field_container').html(widget(display_widget, { field: field }));\n}\nelse if (mode == 'edit') {\n    \n    // if started in edit mode, focus the field and select text (if applicable)\n    if (typeof focused != 'undefined') {\n        w.find('.field_container').html(\n            widget(edit_widget, { field: field, focused: focused })\n        );\n    }\n    else {\n        w.find('.field_container').html(\n            widget(edit_widget, { field: field, focused: false })\n        );\n    }\n}\n\n\nw.on('display_clicked', function(e) {\n    //console.log('display_clicked and display mode is ', mode == 'display' ? 'on' : 'off');\n    e.stopPropagation();\n    if (mode == 'display' && edit_available) {\n        w.find('.field_container').html(widget(edit_widget, { field: field }));\n        mode = 'edit';\n    }\n});\n\nw.on('field_changed', function(e) {\n    //console.log('field changed and display mode is ', mode == 'display' ? 'on' : 'off');\n    e.stopPropagation();\n    if (mode == 'edit' && display_available) {\n        w.find('.field_container').html(widget(display_widget, { field: field }));\n        mode = 'display';\n    }\n});\n\n\n\n
\\x6bc6d2e950ff647b21bb6df63efd6ddd6f7dd5aeeda2447670d80a9be48ec42b	8d127696-d3d7-4d7e-8336-0821da3c9a55
\\x6e6716181625c607c66f176696f7eddbc5fb3915a8f14e4ddca7d6a194e0d9fd	form_field
\\x6fec21f61e6e358ad0b464f82e4fdb7c2b4ac9e9ac273569a158da8fbc27b7e1	2c61d48d-8ade-4057-a506-62f5d2c47af7
\\x6ff322ef1c377dc54d6bb0d1766caa28b10f59b05dafbbe2306bae1c45302491	("(meta)",schema_id)
\\x70d9efcbd5a6925d45c0f2c0f4cbaf57a68d6d52fc02af903d93cdb491a3962f	var w = $('#'+id);\n\nfunction display() {\n    var val = field.value;\n    \n    if (val == null) {\n        val = 'NULL';\n    }\n    \n    else if (val == '') {\n        val = '____';\n    }\n    \n    w.find('.display').html(val);\n    w.find('input').val(val);\n    \n    w.removeClass('saving')\n    .removeClass('editing')\n    .addClass('displaying');\n    \n    //w.find('.edit input').prop('disabled', false);\n}\ndisplay();\n\nfunction edit() {\n    w.removeClass('displaying')\n    .removeClass('saving')\n    .addClass('editing');\n    w.find('input').focus();\n}\n\n\nfunction save(saving_as_null) {\n    \n    w.removeClass('displaying')\n    .removeClass('editing')\n    .addClass('saving');\n    \n    //w.find('.edit input').prop('disabled', true);\n\n    var old_value = field.value;\n\n    // save\n    if (saving_as_null) {\n        field.set(null);\n    }\n    else {\n        field.set(w.find('input').val());\n    }\n    \n    field.update().then(function() {\n        w.trigger('status', ['Saved', 'success']);\n        w.trigger('form_field_save');\n        display();\n        \n    }).catch(function(error) {\n        field.set(old_value);\n        w.trigger('status', ['Failed save', 'fail']);\n        display();\n    });\n}\n\n\n// EVENT BINDINGS\nw.find('.save').on('click', save.bind(this, false));\nw.find('.save_as_null').on('click', save.bind(this, true));\nw.find('.display').on('click', edit);\nw.find('.cancel').on('click', display);\nw.find('input').on('keyup', function(e) {\n    if (e.keyCode == 27) {\n        display();\n    }\n    if (e.keyCode == 13) {\n        save(false);\n    }\n});\n
\\x728b4a0becf0db1cbd1732bdccf3239b327a63b9c8233c84cd4b983103c1f94b	122b29f3-4029-4065-a0b4-465bac4be286
\\x7329622881a8cd75cf7a9f4d3bc8f6df0f74d794095fc8b6b750e4a85943c90b	widget/widget
\\x74234e98afe7498fb5daf1f36ac2d78acc339464f950703b8c019892f982b90b	null
\\x748212ef60de2d4a77b73108d91102355890ba62c569c2cb917096646bd3b6f0	8e90a3d1-a547-4e40-bcec-11359a7b0a94
\\x789e00419b9f9532c2bf1cb4552b115b51bf5b17ffb763535c808024a3882caa	250ac742-3a66-47e2-a173-0ec9090061f5
\\x7a9e3c6e54179f8954a4fb92e4cfb4c21eacd2e9ee79988d30f59eb732e136b8	grid_edit
\\x7b8b04e09847b289dc47dcb21a5c7fef4df885b7df5e26ceef3766a74e45a087	new_field
\\x7d16aec06238d56a02cfe94c25d1ab9572f5830c09b28d315c0d3b8014602ee5	b9251ff6-33e3-451d-a381-460cad737c71
\\x809ff4571dbdaae2f5b46dbf7be98e31bffe790700b857aec51cac6058e8551d	22d7e730-ce65-42d3-86b1-7c5b8aabbe23
\\x813374804c0e3bd290aa5ee082b722e211ec5d190a0eb3fcd5c454fd0de9f3fc	685b6e67-b3dc-4890-94c4-2b9b09e6e286
\\x867c8f8ba2aea38d629a867a159a559f4a33f7efe6f13fe203197c7744518820	<div id="{{= id }}" class="{{= name }}">\n    <h1>semantics demos</h1>\n    \n    <h3>New Row</h3>\n    <div class='new_row'></div>\n    \n</div>
\\x872743cc4f0e856193fff79814650c0e2a0aa9a633b4bd5b3803602e443163dc	var w = $("#"+id);\n\nvar label = row.relation.schema.name + '.' + row.relation.name + ': ';\n\nif (typeof row.get('name') != 'undefined') label += row.get('name');\nelse if (typeof row.get('path') != 'undefined') label += row.get('path');\nelse if (typeof row.get('mimetype') != 'undefined') label += row.get('mimetype');\nelse label += row.pk_value;\n\nw.html(label);
\\x8d2f9444c9f30d420222243bb2ef96ef29be8b28bde418b06f462f28f3492af1	bf6e6451-88c6-4642-b034-2c72a83ee6ec
\\x8e54789afdb68c45fb948ae2e1b2470929186f8fc3f299d7fbf60d0b79410c56	573d40f7-be20-468a-8140-7d8c318b2e08
\\x9116952ac58a39f6f84719d93c686fc2050ef7d403a156d31dac4098d5974eb1	d268c377-f258-412b-946f-671764b25913
\\x9143b3c38a5aa24dbaa4475fe6dc3e827d9e0f7904389018b2d50f856a578946	c174b1ce-fd10-477d-9ff6-d6c4b5cd2e23
\\x9498075c488bbb47bf55165189f0a9bdb4431d8c88f974bd8eed0bceb2375f59	 var w = $('#'+id);\n\n\n/* SETUP */\nvar rel_name;\nvar relation = datum;\n\nif (!(datum instanceof AQ.Rowset)) {\n    datum = datum.rows()\n    .then(function(rows) {\n        rel_name = rows.relation.schema.name + '.' + rows.relation.name;\n        w.find('.title').text(rel_name);\n        return rows;\n    });\n} else {\n    rel_name = datum.relation.schema.name + '.' + datum.relation.name;\n    relation = rows.relation;\n    w.find('.title').text(rel_name);\n}\n\ncontext = typeof context != 'undefined' ? context : {};\n\n\n// Use columns from meta_data if included\nif (!datum.columns) {\n    var columns = endpoint.schema('meta').table('column').rows({\n        where: {\n            name: 'relation_id',\n            op: '=',\n            value: relation.id\n        },\n        include: ['id', 'name']\n    });\n}\nelse {\n    var columns = Promise.resolve(datum.columns);\n\n}\ncolumns = columns.then(function(col) {\n    return col.map(function(c) {\n        return typeof c.get != 'undefined' ? c.get('name') : c.name;\n    });\n});\n\n// Sync the column names in the table heading\nwidget.sync(columns, w.find('.columns'), function(column) {\n    return '<th>' + column + '</th>';\n});\n\nif (!datum.length) {\n    w.find('.columns').hide();\n}\n\n// Sync the rows in this table\nwidget.sync(datum, w.find('table'), function(row) {\n    return widget('semantics/grid_row', row);\n});\n\n\n// Pop up a new_row widget\nw.find('.new_row').click(function() {\n    w.append(\n        widget('ide:modal', {\n            content: widget('semantics/new_row', relation, { context: context })\n        })\n    );\n});\n\n
\\x99425da74d54d7310c0eccc5676454ec2cfebdb46efc144ca7860cf391eb6f25	<table id="{{= id }}" class="{{= name }}">\n</table>
\\x9a3f0999fa41c6c59fe5a7c091a77eb9c83db3053ea2de6ce0333b0081312182	("(meta)",column_id)
\\x9a4d2386e4b9b1eeab111ca520bae7397c1a82c412b70ccc2b3c60e60e5ccb39	var w = $("#"+id);\n\nvar label = row.relation.schema.name + '.' + row.relation.name + ': ';\n\nif (typeof row.get('name') != 'undefined') label += row.get('name');\nelse if (typeof row.get('path') != 'undefined') label += row.get('path');\nelse if (typeof row.get('mimetype') != 'undefined') label += row.get('mimetype');\nelse if (typeof row.get('url_pattern') != 'undefined') label += row.get('url_pattern');\nelse if (typeof row.get('schema_name') != 'undefined') label += row.get('schema_name');\nelse if (typeof row.get('purpose') != 'undefined') label += row.get('purpose');\nelse if (typeof row.get('column_id') != 'undefined') label += row.get('column_id').relation_id.schema_id.name + '.' +  row.get('column_id').relation_id.name + '.' + row.get('column_id').name;\nelse if (typeof row.get('relation_id') != 'undefined') label += row.get('relation_id').schema_id.name + '.' +  row.get('relation_id').name ;\nelse if (typeof row.get('schema_id') != 'undefined') label += row.get('schema_id').name;\nelse label += row.pk_value;\n\nw.html(label);
\\x9b2f8ed3bd9dc0166b02a09a0db174cc962b3536bdef6056e98f0d7a7939bef8	var w = $("#"+id);\n/*\nvar schema_name = datum.relation.schema.name;\nvar relation_name = datum.relation.name;\n*/\nvar rel_name = datum.relation.schema.name + '.' + datum.relation.name;\n\n\ndatum.fields().forEach(function(field) {\n    w.append('<td>' + widget('semantics/form_field', field) + '</td>');\n});\n\nvar del_button = $('<td><button>Delete</button></td>');\nw.append(del_button);\ndel_button.on('click', function() {\n    datum.delete().then(function() {\n        w.trigger('status', ['Row deleted on ' + rel_name, 'success']);\n        w.remove();\n    }).catch(function() {\n        w.trigger('status', ['Failed delete on ' + rel_name, 'fail']);\n    });\n});\n
\\x9c2c98ea88ec4d4303e618c5df57b5715042af39715f254c6b24fa96a1bf5e9a	var w = $("#"+id);\n\n\nvar fields = row.fields();\nvar show_fields = fields;\n\n\n\nif (typeof field_visibility != 'undefined') {\n\n    if (typeof field_visibility.include_fields != 'undefined') {\n\n        show_fields = $.grep(fields, function(el, i) {\n\n            // if element is in included fields\n            return (field_visibility.include_fields.indexOf(el.name) > -1);\n\n        });\n    }\n\n\n    else if (typeof field_visibility.exclude_fields != 'undefined') {\n        \n        show_fields = $.grep(fields, function(el, i) {\n\n            // if element is not in excluded fields\n            return (field_visibility.exclude_fields.indexOf(el.name) == -1);\n\n        });\n    }\n\n}\n\n\nfor (var i = 0; i < show_fields.length; ++i) {\n    w.append(widget('field_label', { field: show_fields[i] }));\n}
\\x9d991f99aeceacca9394dfd59a1ee1f95c9a41e753be75b070923d5318f25297	340ef112-9934-4c65-9027-37f9a5aea110
\\x9e43cc6a827b137d2a2d7c9a2b4e9266b688a1455d9da164751c1a09cf5a42b2	c2e6b45c-d4eb-4134-b246-84c542718717
\\x9e673b3685596f3be6b21152ccc470f023731999f965c1c3cd4c5ae4bef3c94c	f071b1ed-df9d-4279-ae2d-218b2bfffc14
\\x9e9acb304b964eb671ed80f751f6b4e6ca15dec811fe739c19c26aeafae5f49d	("(""(widget)"",widget)",common_js)
\\x9eafee1e08374527aebde72bea79db9aae7687bbaca274b008220c4986360984	row_detail
\\x9f8b34ca44375804f83809efc28df32e207bc0be9633f114bbbd987d99247507	f32898b2-412a-41ce-a610-39e756db0321
\\x9fc9de9b85b1961f2df700048f6c3d5ea6a8c2c11a96f06c8d3cafbd7318aeab	("(""(endpoint)"",resource)",content)
\\xa10944763ae972ce7c24fa42809c9b6b0e4a043417009e53bfa022b2c6a44eec	("(""(widget)"",widget)",css)
\\xa448749af7a9339e1e1370b50e365ab3cb28252b2d9634a7aaa075a334c41ba8	a38553f8-c86c-4318-a39c-0f0e1aee5954
\\xa5c5a662cb13c952deb1c07c138e02e66fdcf1ed5ba435c4d7d3109143009f72	ef554d45-011b-4c93-9c8f-887d870dd0e6
\\xa5e64d2bbd1bc386d46e5ff99d8226d5b984f025351b4036d4746b589e3a6f16	<li id="{{= id }}" class="{{= name }}">\n    <a title="{{= link_label(row) }}">{{= link_label(row) }}</a>\n</li>
\\xa7ea5ef51c07e04145d9fefa387310b450c99d6cd01ec3e494efb0d65b9a71b2	endpoint/resource
\\xa8ad16b2bdbce0f7ffac9cbfbef7b174b7f5544441fa7b7f7c280fabcb0f81ba	("(""(widget)"",widget_route)",args)
\\xa8cc5e4f18b3f569cc9a3d13e15b3f7a9d1a84ea2efb9887ba326b681b38fa01	table.{{= name }},\ntable.{{= name }} td,\ntable.{{= name }} th,\ntable.{{= name }} tr {\n    border: 1px solid #666;\n    border-collapse: collapse;\n    padding: 0.5rem;\n}\n\n.{{= name }} .no_border {\n    border: none;\n}
\\xb4b611e1db81c856d6139d6297e1f2cc4b0acde91154d69a1a69d48ab539c2fb	5cc67297-5959-4bbd-b113-30ca581c6180
\\xb551d0b29174d8cc68e525c76f3a446938fdb8a8735611b1dcff42552ee3babb	new_row
\\xb5bea41b6c623f7c09f1bf24dcae58ebab3c0cdd90ad966bc43a45b44867e12b	true
\\xb952ec69aff5cdb1a0fb30e61e6bb48a0e037081b4ee9b8a598091cd5351f887	<table id="{{= id }}" class="{{= name }}">\n    <tr>\n        <th class='no_border'>\n            <button class='delete_row'>Delete</button>\n            <button class='save_row'>Save</button>\n        </th>\n        <th class='no_border'></th>\n    </tr>\n    <tr>\n        <th>Field</th>\n        <th>Data</th>\n    </tr>\n</table>
\\xb9632eef5a878a53792021f85b348a00465ec6cac72cbe7f4870ba95735e49bf	9ab9441c-b4d5-4ad4-86eb-e0d4048b0195
\\xba0a1382f0c91f1e1f49286a12356f91dcc0f9aed1856221fe017a60d8a91cbc	<li id="{{= id }}" class="{{= name }}">\n    {{= row.get('name') || row.get('id') }}\n</li>
\\xbd37d14f4da6e36e857986ad8b2e595a8fb14838422fa2ec4d2e7edef4c3a3c1	6159ecb9-3821-4a57-8463-fab618da324b
\\xc2e82b51b9ddb4148f4da65297ff2b7526d9e470d40c2d3ba923806b25d3e865	2e8ca7b6-777d-4c06-94b7-efdfa651f16a
\\xc5c5de5caec48ee402d8b33f8174a92c0639cde41563eaa3e1e65f5c99840e7d	50697996-f20f-4e45-9c4c-f3041dee2629
\\xc60a2c8ce25d400c62a55451ccbdbb7c53ef85fe41de68098309811e2a5e122b	<div id="{{= id }}" class="{{= name }}">\n    <span class='rel_name'></span>\n    <button class='save'>Save</button>\n    <div class='fields'></div>\n</div>
\\xc71d318f44f6b01920e2ea3262d4f3553bb4433005e84edfac1ea7c2e81ac7be	c62d2ceb-6ed2-49ff-857a-f790d40111c8
\\xc78cd7f7852b66366a7f9bca312d6f34d26659173e797f541875c99bee366529	<div id="{{= id }}" class="{{= name }}">\n    <table class="fields">\n        <tr>\n            <th class='no_border'>\n                <button class='save_row'>Save</button>\n            </th>\n            <th class='no_border'></th>\n        </tr>\n        <tr>\n            <th>Field</th>\n            <th>Data</th>\n        </tr>\n    </table>\n</div>
\\xc7ef3377c5445b6bbda6f2b30a0e7275c5e5e7cd76b91a2f1e4243eb55edaea0	8455594e-0a7c-497b-bdab-336f8cb56f51
\\xcafee5e9f312b89f09df04f26c857646956980871125002ceefd646e69ded80f	var w = $("#"+id);\n\nvar t = endpoint.schema('semantics_test').table('test');\n\nw.find('.new_row').html(widget('semantics/new_row', t));
\\xd01da7bd78a7769e0bc713a64d0e7860bf137ed031c617210465532d9814fd57	form_field_edit uuid
\\xd2005e4f96beb6c47cd1f8fc00f281e0e025715fe8f393edc0805d060f29c905	188d7c72-3d13-4508-b68a-b07733e48454
\\xd42bf06032932bb5b2e147f8a4baf75fe319b5abec16194bf8fc133501a0b72f	grid_row
\\xd7d37b84fbcddc7c73deeb04ed0bdd8b33bc2fb4068a261b1c36db41c72a532e	if (typeof click_handler != 'undefined') \n    $('#'+id).click(click_handler);
\\xdc514bfe618591b14aba4e6069de12537fb3cd0991ac60fc58ae915fd8d4f057	.{{= name }} {\n    position: relative;\n\tcursor: pointer;\n    padding-left: .5em;\n    padding-right: .5em;\n}\n\n.{{= name }}:hover {\n    background-color: #222;\n}\n\n\n.{{= name }}.selected {\n    background-color: #333;\n}\n\n\n.{{= name }} a {\n    text-decoration: none;\n    display: block;\n    overflow: hidden;\n    text-overflow: ellipsis;\n}
\\xdd2741e2734916143a6dbf1d1939cbc04396f10356faf54aba282066cec41b5f	944b5a05-be70-45a1-a549-1301d38799e4
\\xdd880e5144a1af9f78fe7f11a5ec9723f517ca45c1b3aa731a0b86c86b679944	2766f45b-c89f-45c5-bbb2-ea1106bc96d7
\\xe3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855	
\\xe4b08665b2511bc86ca7cf1116f4a4df34ec5c7f0a19329e166cd8a00e862382	return {};
\\xe6a57205bbdb80db3ba8ae4c064cb1951fbbef0f92e928392c8afbb3bda1854f	grid_display
\\xe720a1abb1b786bf08e43c5bbe861915676e69db72a0f21cb2d15e04f8baf073	.{{= name }} {\n} \n\n.{{= name }}:not(.displaying) > .display {\n    display: none;\n}\n\n.{{= name }} > .display:hover {\n    text-decoration: underline;\n    cursor: hand;\n    cursor: pointer;\n}\n\n.{{= name }}:not(.editing) > .edit {\n    display: none;\n}\n\n.{{= name }}:not(.saving) > .save {\n    display: none;\n}\n
\\xe7a0ac8750f8729ce07cbfcb9604bd52e1ce3041968e276262eb17c7f3454238	list_view
\\xea5eeec8ba4b0a547edfaba32a97bc0f59d6a0efbe679c87555be4cc31ffee3b	("(""(widget)"",widget)",pre_js)
\\xec99d7545f96b7ebfccd8011f7b2b9b12c77e4cdbd3da5d8e6ee9cdb3b33193e	f6c5abc9-3f72-42c6-ba43-10e51b46beaa
\\xecb91a2d782f8c03a8e5efb67d11a374496756e432ae7e9084509094ca2a071c	var w = $("#"+id);\n\n\nrow.relation.row(row.pk_column_name, row.pk_value)\n.then(function(row) {\n    var rel_name = row.relation.schema.name + '.' + row.relation.name;\n\n    row.columns.forEach(function(col) {\n        w.append(\n            '<tr>' +\n            \t'<td>' + \n\t\t            widget('semantics/form_label', row.field(col.name)) + \n        \t    '</td>' +\n            \t'<td>' + \n\t\t            widget('semantics/form_field', row.field(col.name)) + \n\t            '</td>' +\n            '</tr>');\n    });\n\n\n    w.find('.delete_row').on('click', function() {\n        if (confirm('Are you sure you\\'d like to delete this row?')) {\n            row.delete()\n            .then(function() {\n                w.trigger('status', ['Row deleted from ' + rel_name, 'success']);\n                w.trigger('row_detail_delete');\n                w.trigger('done');\n                w.remove();\n            })\n            .catch(function() {\n                w.trigger('status', ['Failed delete on ' + rel_name, 'fail']);\n            });\n        }\n    });\n});
\\xecf4cfc71a91771e68028c115b83a6a9adbeb7993ec5c58aa16ed7c09b346bb8	var w = $("#"+id);\n\nvar label = row.relation.schema.name + '.' + row.relation.name + ': ';\n\nif (typeof row.get('name') != 'undefined') label += row.get('name');\nelse if (typeof row.get('title') != 'undefined') label += row.get('title');\nelse if (typeof row.get('path') != 'undefined') label += row.get('path');\nelse if (typeof row.get('mimetype') != 'undefined') label += row.get('mimetype');\nelse if (typeof row.get('url_pattern') != 'undefined') label += row.get('url_pattern');\nelse label += row.pk_value;\n\nw.html(label);
\\xef05275ab4c172893b18566a43efcf07b30f0f4ee0c85dd2ca965c5d507a318c	<span id="{{= id }}" class="{{= name }} a">\n    <nobr>\n    <span class='label'>\n    </span>\n    </nobr>\n</span>
\\xefd014e3d8f8c8fd618c89a16fdf14766c5d8ddfb18902c0ceef2ed074d1f435	var w = $("#"+id);\n\nvar rel_name = datum.schema.name + '.' + datum.name;\nw.find('.rel_name').text(rel_name);\n\ncontext = typeof context != 'undefined' ? context : {};\n\nendpoint.schema('meta').table('column').rows({\n    where: [{\n        name: 'relation_id',\n        op: '=',\n        value: datum.id\n    }, {\n        name: 'primary_key',\n        op: '=',\n        value: false\n    }],\n    include: ['id', 'name']\n})\n.then(function(columns) {\n    \n    if (!columns.length) {\n        w.text('Inserting defaults...');\n        return setTimeout(insert, 2000);\n    }\n    \n    widget.sync(columns, w.find('.fields'), function(c) {\n        if (Object.keys(context).indexOf(c.get('name')) == -1) {\n            return widget('semantics/new_field', datum.column(c.get('name')));\n        }\n    });\n});\n\n\nw.find('.save').on('click', save);\nw.on('save', save);\n\nfunction save(e) {\n    e.stopPropagation();\n    \n    var new_fields = w.find('> .fields > *');\n    var args = {};\n    var invalid;\n    \n    for (var i = 0, f; i < new_fields.length; i++) {\n        f = $(new_fields[i]);\n        //console.log(f.data('valid'), f.data('name'), f.data('value'));\n        \n        if (!f.data('valid')) {\n            f.addClass('invalid');\n            invalid = true;\n        }\n        if (typeof f.data('value') == 'undefined') {\n            continue;\n        }\n        args[f.data('name')] = f.data('value');\n    }\n\n    if (!invalid) {\n        insert(args);\n    }\n}\n\nfunction insert(args) {\n    \n    args = Object.assign(args || {}, context);\n    \n    datum.insert(args)\n    .then(function() {\n        w.trigger('status', ['New row on ' + rel_name, 'success']);\n        w.trigger('done');\n    }).catch(function() {\n        w.trigger('status', ['Failed insert on ' + rel_name, 'fail']);\n    });\n}\n\n
\\xefd4771d5cd85cf73d5f141b7804a27b10332a904a6377b90da1ade93745618d	3da8b760-d32d-4472-bdc0-8e93ea8c53ac
\\xf075419c90a9c9e126173bf4bd1d45890c1118c0171aa72f4784965bd38e9d7c	cafc69ba-e748-4695-a5be-b9dfe803aff5
\\xf11dfa429c3275044630b356148ccef903f554b97a4f38b885aeb7f9e0321e30	form_field_WEIRD_DUPLICATE
\\xf3498573b89bfc70aefc01efb96fbae34cdc097e0669c98777f900478813626d	486d1939-8093-40b9-b790-a6d1675727c8
\\xf358a3f117d35711acacade4bc2fa86714a2195d427dffea9629b8897308f915	<tr id="{{= id }}" class="{{= name }}">\n    <td class='label'></td>\n    <td class='field_container'></td>\n</tr>
\\xf3d156e7070072c44cec83eb6247b507bd0c6ff920d39d23b34764739122d67b	d1f29c6b-b861-40de-be53-a8ee785b1cfc
\\xf3e4f44290db4f289df8aa4f1c342048590b37cb000dd310e2cca7eccde852c0	var w = $('#'+id);\n\nw.data('datum', row);\nw.data('row', row);\n\n// Assign all triggers\n['click'].forEach(function(trig) {\n    w.on(trig, function(e) {\n        e.stopPropagation();\n        w.trigger('list_item_' + trig, [row, w]);\n    });\n});
\\xf8cf6ec2d44d14e4910fcb6247301b6b2133ec216c365f4861f9093afb2c3343	d97b737d-e9d3-4238-96f1-b952a1c37230
\\xf92266fc259baec964599e8d421159d93015fdbbf7965d00716b2b53b7870d9c	2643fd82-2eba-4123-bf7a-b9c0daa1adcb
\\xf9dd1187eba02eea612854b78824cb2e39b7abf66c3db4fb80b0a4250eedc531	<div id="{{= id }}" class="{{= name }}">\n    <div class='title'></div>\n    <table>\n        <tr class='columns'></tr>\n    </table>\n    <button class="new_row">new row</button>\n</div>
\\xfa4dca6dd63f254176e438667df3d356c443159a22538d2aec63220de1366fe1	("(meta)",row_id)
\\xfceddd32bf5156ea68a7d116c0bf36b1095a1c6b510385429b4586d62664a774	("(meta)",relation_id)
\\xfece0b98c8fa3ac9b50d2470d0d7401ad9672529c1a251819bb2d99ae2d76e69	f69056cc-c718-4835-a091-d12380639e79
\\xff8a5487bc6aa2f730e9c2963d25810c52e78e16091fe273a94fc0b0053c2f34	grid_field_edit
\\xffbecc06a7cc2b5c212136159b4ade752fd56887a3a0e337772cdf60d8adeaf9	<span id="{{= id }}" class="{{= name }} displaying">\n    <span class='display'></span>\n    <span class='edit'>\n        <input type='text' value='{{= field.value }}'>\n        <button class='save'>Save</button>\n        <button class='cancel'>Cancel</button>\n        <button class='save_as_null'>Save as null</button>\n    </span>\n    <span class='save'>\n        saving...\n    </span>\n</span>\n
